from scipy.cluster.hierarchy import dendrogram
import matplotlib.pyplot as plt
import numpy as np
from turtle import pen
from sklearn.cluster import AgglomerativeClustering
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
iris = load_iris()
data = iris.data[:, [1, 3]]

ac = AgglomerativeClustering(
    n_clusters=3, affinity='euclidean', linkage='complete')
ac.fit_predict(data)
print(ac.fit_predict(data))
"""
実行結果
[2 0 0 0 2 2 2 2 0 0 2 2 0 0 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 0 0 2 2 2 0 0 2
 2 0 2 2 0 0 2 2 0 2 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 1 1 0 0 1 1 1
 1 1 1 1 1 0 1 1 0 1 1 1 1 1 0 1 0 1 0 1 1 1 0 0 1 1 0 0 1 1 1 1 1 1 1 1 1
 1 0]
"""

print(end='\n')
children = ac.children_  # 1
distance = np.arange(children.shape[0])  # 2
no_of_observations = np.arange(2, children.shape[0]+2)  # 3
linkage_matrix = np.hstack(
    (children, distance[:, np.newaxis], no_of_observations[:, np.newaxis])).astype(float)
print(linkage_matrix)
"""
実行結果
[[  0.  27.   0.   2.]
 [  1.  25.   1.   3.]
 [  2.  29.   2.   4.]
 [  3.  30.   3.   5.]
 [  4.  22.   4.   6.]
 [  5.  16.   5.   7.]
 [  7.  11.   6.   8.]
 [ 20. 156.   7.   9.]
 [ 24. 157.   8.  10.]
 [ 28. 158.   9.  11.]
 [ 39. 159.  10.  12.]
 [ 38. 151.  11.  13.]
 [ 34. 153.  12.  14.]
 [ 10.  48.  13.  15.]
 [ 12.  13.  14.  16.]
 [ 18.  19.  15.  17.]
 [ 17.  40.  16.  18.]
 [ 26.  31.  17.  19.]
 [ 36. 150.  18.  20.]
 [ 35. 152.  19.  21.]
 [ 42. 169.  20.  22.]
 [ 47. 170.  21.  23.]
 [ 57.  81.  22.  24.]
 [ 69.  98.  23.  25.]
 [ 90.  92.  24.  26.]
 [ 53.  87.  25.  27.]
 [ 68. 119.  26.  28.]
 [ 55.  71.  27.  29.]
 [ 99. 177.  28.  30.]
 [ 58.  64.  29.  31.]
 [ 74. 179.  30.  32.]
 [ 96. 180.  31.  33.]
 [ 97. 181.  32.  34.]
 [ 75.  91.  33.  35.]
 [ 54. 133.  34.  36.]
 [101. 111.  35.  37.]
 [142. 185.  36.  38.]
 [ 61.  66.  37.  39.]
 [ 84. 187.  38.  40.]
 [ 52.  86.  39.  41.]
 [116. 127.  40.  42.]
 [138. 190.  41.  43.]
 [149. 191.  42.  44.]
 [103. 107.  43.  45.]
 [ 70. 125.  44.  46.]
 [102. 105.  45.  47.]
 [112. 195.  46.  48.]
 [121. 122.  47.  49.]
 [135. 145.  48.  50.]
 [115. 120.  49.  51.]
 [143. 199.  50.  52.]
 [100. 144.  51.  53.]
 [ 21.  44.  52.  54.]
 [ 46. 163.  53.  55.]
 [ 49. 171.  54.  56.]
 [ 62.  93.  55.  57.]
 [ 73.  82.  56.  58.]
 [ 59.  76.  57.  59.]
 [ 94. 178.  58.  60.]
 [123. 126.  59.  61.]
 [130. 186.  60.  62.]
 [104. 198.  61.  63.]
 [108. 146.  62.  64.]
 [ 63. 182.  63.  65.]
 [ 88. 183.  64.  66.]
 [ 77. 129.  65.  67.]
 [  6. 160.  66.  68.]
 [ 45. 161.  67.  69.]
 [166. 168.  68.  70.]
 [  9. 162.  69.  71.]
 [ 37. 154.  70.  72.]
 [ 67.  79.  71.  73.]
 [ 80. 172.  72.  74.]
 [ 78. 184.  73.  75.]
 [188. 189.  74.  76.]
 [192. 193.  75.  77.]
 [ 50.  65.  76.  78.]
 [ 56.  85.  77.  79.]
 [137. 194.  78.  80.]
 [147. 196.  79.  81.]
 [128. 197.  80.  82.]
 [141. 200.  81.  83.]
 [136. 148.  82.  84.]
 [207. 208.  83.  85.]
 [209. 210.  84.  86.]
 [165. 203.  85.  87.]
 [ 14.  32.  86.  88.]
 [110. 124.  87.  89.]
 [173. 174.  88.  90.]
 [ 89. 134.  89.  91.]
 [213. 214.  90.  92.]
 [  8. 217.  91.  93.]
 [ 23. 167.  92.  94.]
 [216. 218.  93.  95.]
 [164. 219.  94.  96.]
 [ 51. 226.  95.  97.]
 [139. 229.  96.  98.]
 [140. 231.  97.  99.]
 [155. 202.  98. 100.]
 [114. 132.  99. 101.]
 [ 72. 106. 100. 102.]
 [113. 212. 101. 103.]
 [ 33. 236. 102. 104.]
 [117. 131. 103. 105.]
 [205. 222. 104. 106.]
 [175. 176. 105. 107.]
 [206. 233. 106. 108.]
 [ 83. 223. 107. 109.]
 [118. 249. 108. 110.]
 [215. 224. 109. 111.]
 [ 95. 240. 110. 112.]
 [211. 247. 111. 113.]
 [ 43. 242. 112. 114.]
 [241. 244. 113. 115.]
 [221. 238. 114. 116.]
 [201. 232. 115. 117.]
 [235. 248. 116. 118.]
 [220. 243. 117. 119.]
 [225. 228. 118. 120.]
 [109. 265. 119. 121.]
 [239. 256. 120. 122.]
 [230. 234. 121. 123.]
 [237. 246. 122. 124.]
 [227. 245. 123. 125.]
 [259. 268. 124. 126.]
 [204. 263. 125. 127.]
 [ 60. 254. 126. 128.]
 [261. 272. 127. 129.]
 [251. 271. 128. 130.]
 [264. 270. 129. 131.]
 [250. 257. 130. 132.]
 [ 15. 252. 131. 133.]
 [262. 267. 132. 134.]
 [273. 274. 133. 135.]
 [255. 276. 134. 136.]
 [260. 279. 135. 137.]
 [266. 282. 136. 138.]
 [258. 278. 137. 139.]
 [253. 269. 138. 140.]
 [280. 285. 139. 141.]
 [277. 288. 140. 142.]
 [ 41. 275. 141. 143.]
 [283. 289. 142. 144.]
 [281. 286. 143. 145.]
 [287. 290. 144. 146.]
 [284. 292. 145. 147.]
 [291. 295. 146. 148.]
 [293. 296. 147. 149.]
 [294. 297. 148. 150.]]
"""

print(end='\n')
fig, ax = plt.subplots(figsize=(20, 10), dpi=100)
# dendrogram(linkage_matrix, leaf_font_size=8)
dendrogram(linkage_matrix, leaf_font_size=8, color_threshold=np.inf)
plt.show()
